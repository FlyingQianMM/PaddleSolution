# 3.3.1 Mask_R-CNN评估



## 目录
  * [1. 参数调整](#1-参数调整)
  * [2. 启动评估](#2-启动评估)

## 1. 参数调整

在启动评估前，需在配置文件中指定待评估模型以及数据集的存储路径。这里以使用[mask_rcnn_r50_vd_fpn.yml](../../configs/mask_rcnn_r50_vd_fpn.yml)为例，展示如何调整这些参数：

* [`weights`](https://github.com/FlyingQianMM/PaddleSolution/blob/3db658f8bb522e936663fea89970742d1f893dac/configs/mask_rcnn_r50_vd_fpn.yml#L12): 待评估模型的存储路径。默认为训练时最后一次迭代时保存的模型参数，即output/mask_rcnn_r50_vd_fpn/model_final，可自定义。例如，当使用PaddleSolution提供的在COCO训练集上训练好的模型时，下载并解压至PaddleSolution的目录下，则`weights`需改为mask_rcnn_r50_vd_fpn。#注意改云端模型的名字

* * [`MaskRCNNEvalFeed`](https://github.com/FlyingQianMM/PaddleSolution/blob/3db658f8bb522e936663fea89970742d1f893dac/configs/mask_rcnn_r50_vd_fpn.yml#L147)：验证集的数据预处理。
  * [`dataset_dir`](https://github.com/FlyingQianMM/PaddleSolution/blob/3db658f8bb522e936663fea89970742d1f893dac/configs/mask_rcnn_r50_vd_fpn.yml#L151)：COCO数据集的存储路径。默认设置为dataset/coco。
  * [`image_dir`](https://github.com/FlyingQianMM/PaddleSolution/blob/3db658f8bb522e936663fea89970742d1f893dac/configs/mask_rcnn_r50_vd_fpn.yml#L152)：验证集中图片的存储路径。默认设置为val2017。
  * [`annotation`](https://github.com/FlyingQianMM/PaddleSolution/blob/3db658f8bb522e936663fea89970742d1f893dac/configs/mask_rcnn_r50_vd_fpn.yml#L153): 验证集中真值的存储路径。默认设置为annotations/instances_val2017.json。
  * 均值和方差(#缺脚本)

## 2. 启动评估

目前仅支持使用单块显卡进行评估，模型的路径通过[mask_rcnn_r50_vd_fpn.yml]()中`weights`来指定。
  * 评估和测试阶段所需的模型参数的路径。默认为训练时最后一次迭代时保存的模型参数，即output/mask_rcnn_r50_vd_fpn_2x/model_final，可自定义。

```
export CUDA_VISIBLE_DEVICES=0
python tools/eval.py -c configs/mask_rcnn_r50_vd_fpn.yml
```
运行结束后，终端会输出多项指标的数值，各项指标的具体含义请参考[COCO数据集官方文档](http://cocodataset.org/#detection-eval)。这里只考虑`Average Precision(AP) @ [ IoU=0.50:0.95 | area= all | maxDets=100 ]`，该项指标的数值越高，表示模型的精度越高。
